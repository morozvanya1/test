<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Fitness App</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      margin: 0;
      padding: 16px;
      font-family: -apple-system, BlinkMacSystemFont, system-ui;
      background: #0e1621;
      color: #e7e8ea;
      display: flex;
      justify-content: center;
    }
    .container {
      width: 100%;
      max-width: 420px;
    }
    h1, h3 {
      text-align: center;
    }
    .card {
      background: #17212b;
      padding: 14px;
      border-radius: 14px;
      margin-bottom: 16px;
    }
    input, select, button {
      width: 100%;
      padding: 12px;
      margin-top: 8px;
      border-radius: 12px;
      border: none;
      background: #0e1621;
      color: #fff;
    }
    input[type=number] {
      -moz-appearance: textfield;
    }
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    button {
      background: #2aabee;
      font-weight: 600;
      cursor: pointer;
    }
    .exercise {
      border-top: 1px solid #22303c;
      padding-top: 8px;
      margin-top: 8px;
    }
    .actions {
      display: flex;
      gap: 8px;
      margin-top: 6px;
    }
    .actions button {
      padding: 6px;
      font-size: 12px;
      background: #22303c;
    }
    .day {
      margin-top: 12px;
    }
  </style>
</head>
<body>
<div class="container">

<h1>üèãÔ∏è Fitness</h1>

<div class="card">
  <select id="exercise">
    <option value="">–í—ã–±–µ—Ä–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</option>
    <option>–ñ–∏–º –ª—ë–∂–∞</option>
    <option>–ü—Ä–∏—Å–µ–¥</option>
    <option>–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞</option>
    <option>–ñ–∏–º –ø–ª–µ—á</option>
    <option>–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è</option>
  </select>
  <input id="sets" type="number" inputmode="numeric" placeholder="–ü–æ–¥—Ö–æ–¥—ã" />
  <input id="reps" type="number" inputmode="numeric" placeholder="–ü–æ–≤—Ç–æ—Ä—ã" />
  <input id="weight" type="number" inputmode="numeric" placeholder="–í–µ—Å (–∫–≥)" />
  <button onclick="saveWorkout()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
</div>

<div class="card">
  <h3>–ò—Å—Ç–æ—Ä–∏—è</h3>
  <div id="history"></div>
</div>

</div>

<script>
const STORAGE_KEY = 'fitness_local'
let editId = null

function getData() {
  return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]')
}

function saveData(data) {
  localStorage.setItem(STORAGE_KEY, JSON.stringify(data))
}

function saveWorkout() {
  const exercise = document.getElementById('exercise')
  const sets = document.getElementById('sets')
  const reps = document.getElementById('reps')
  const weight = document.getElementById('weight')

  if (!exercise.value) return alert('–í—ã–±–µ—Ä–∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ')

  const data = getData()

  if (editId) {
    const w = data.find(x => x.id === editId)
    if (!w) return
    w.name = exercise.value
    w.sets = +sets.value
    w.reps = +reps.value
    w.weight = +weight.value
    editId = null
  } else {
    data.push({
      id: crypto.randomUUID(),
      name: exercise.value,
      sets: +sets.value,
      reps: +reps.value,
      weight: +weight.value,
      date: Date.now()
    })
  }

  saveData(data)
  exercise.value = ''
  sets.value = ''
  reps.value = ''
  weight.value = ''
  render()
}

function editWorkout(id) {
  const w = getData().find(x => x.id === id)
  if (!w) return
  document.getElementById('exercise').value = w.name
  document.getElementById('sets').value = w.sets
  document.getElementById('reps').value = w.reps
  document.getElementById('weight').value = w.weight
  editId = id
}

function deleteWorkout(id) {
  saveData(getData().filter(x => x.id !== id))
  render()
}

function render() {
  const history = document.getElementById('history')
  history.innerHTML = ''

  const grouped = {}
  getData().forEach(w => {
    const day = new Date(w.date).toLocaleDateString()
    grouped[day] ??= []
    grouped[day].push(w)
  })

  Object.keys(grouped).reverse().forEach(day => {
    const dayDiv = document.createElement('div')
    dayDiv.className = 'day'
    dayDiv.innerHTML = `<b>${day}</b>`

    grouped[day].forEach(w => {
      const div = document.createElement('div')
      div.className = 'exercise'
      div.innerHTML = `
        ${w.name}<br>
        ${w.sets} √ó ${w.reps} ‚Ä¢ ${w.weight} –∫–≥
        <div class="actions">
          <button onclick="editWorkout('${w.id}')">‚úèÔ∏è</button>
          <button onclick="deleteWorkout('${w.id}')">‚úñ</button>
        </div>`
      dayDiv.appendChild(div)
    })

    history.appendChild(dayDiv)
  })
}

render()
</script>
</body>
</html>
